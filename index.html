<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Above Ground Biomass Plot to Map Comparison • Plot2Map</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="lightswitch.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Above Ground Biomass Plot to Map Comparison">
<meta name="description" content="Plot2Map is a workflow for automating aboveground biomass plot to map comparison. It filters deforested plots, adjusts plot biomass temporally to align with map years, corrects for forest fraction at support units, and compares adjusted plots with biomass maps. The package handles various support units and incorporates growth increment data for temporal adjustments.">
<meta property="og:description" content="Plot2Map is a workflow for automating aboveground biomass plot to map comparison. It filters deforested plots, adjusts plot biomass temporally to align with map years, corrects for forest fraction at support units, and compares adjusted plots with biomass maps. The package handles various support units and incorporates growth increment data for temporal adjustments.">
<meta property="og:image" content="https://atnt.github.io/Plot2Map/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">Plot2Map</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="articles/plot-data-preparation.html">Plot data preparation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="plot2map-">Plot2Map <a class="anchor" aria-label="anchor" href="#plot2map-"></a>
</h1>
</div>
<p><a href="https://github.com/aTnT/Plot2Map/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/aTnT/Plot2Map/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a> <a href="https://github.com/aTnT/Plot2Map/actions/workflows/test-coverage.yaml" class="external-link"><img src="https://github.com/aTnT/Plot2Map/actions/workflows/test-coverage.yaml/badge.svg" alt="test-coverage"></a> <a href="https://github.com/aTnT/Plot2Map/actions/workflows/pkgdown.yaml" class="external-link"><img src="https://github.com/aTnT/Plot2Map/actions/workflows/pkgdown.yaml/badge.svg" alt="pkgdown"></a></p>
<p>Plot2Map is an R package for comparing forest plot data to biomass maps, with a focus on Above Ground Biomass (AGB) estimation and validation.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install Plot2Map from GitHub:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"aTnT/Plot2Map"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="what-plot2map-can-be-used-for">What Plot2Map can be used for<a class="anchor" aria-label="anchor" href="#what-plot2map-can-be-used-for"></a>
</h2>
<ul>
<li>Pre-processing various types of plot data (point data, polygons, tree-level measurements, lidar)</li>
<li>Temporal adjustment of plot data to match map epoch</li>
<li>Estimation of measurement and sampling errors</li>
<li>Validation of global AGB maps</li>
<li>Support for custom forest masks</li>
<li>Aggregation of results at different spatial scales</li>
</ul>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<div class="section level3">
<h3 id="plot-data-pre-processing">Plot data pre-processing<a class="anchor" aria-label="anchor" href="#plot-data-pre-processing"></a>
</h3>
<p>Here’s a basic workflow using Plot2Map. We’ll be using the plots dataset provided with the package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://aTnT.github.io/Plot2Map/" class="external-link">Plot2Map</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load sample plot data. In a real application, this would be your own data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">plots</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">plots</span><span class="op">)</span></span>
<span><span class="co">#   PLOT_ID   POINT_X     POINT_Y AGB_T_HA AVG_YEAR SIZE_HA</span></span>
<span><span class="co"># 1    AFR7  24.53906   0.9925556   407.60   2011.5       1</span></span>
<span><span class="co"># 2    AFR7  24.52981   0.8063056   291.20   2011.5       1</span></span>
<span><span class="co"># 3    AFR7  24.52256   0.8274167   366.00   2011.5       1</span></span>
<span><span class="co"># 4   AFR10  12.74900   6.2112000    24.90   2007.0       1</span></span>
<span><span class="co"># 5    AUS1 145.62743 -37.5924562   699.46   2014.0       1</span></span>
<span><span class="co"># 6    AUS1 115.98288 -34.5775977   595.41   2012.0       1</span></span></code></pre></div>
<p>We now preprocess the sampled plot data. The first step is to remove plots that have been deforested based on the Global Forest Change (GFC) dataset (Hansen et al., 2013). We use <code><a href="reference/Deforested.html">Deforested()</a></code> that processes each plot, downloads the necessary GFC forest loss tiles, and determines if the plot has been deforested beyond a set deforestation threshold or if the deforestation occurred before or during the specified map year. In the example below we use the default 5% deforestation threshold, and we will validate an AGB map from 2022:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To reduce data download needs we will only use plots within the "EU2" plot id region</span></span>
<span><span class="co"># Keep in mind that this still requires a significant amount of data to be downloaded</span></span>
<span><span class="va">preprocessed_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/Deforested.html">Deforested</a></span><span class="op">(</span><span class="va">plots</span><span class="op">[</span><span class="va">plots</span><span class="op">$</span><span class="va">PLOT_ID</span> <span class="op">==</span> <span class="st">"EU2"</span>, <span class="op">]</span> , map_year <span class="op">=</span> <span class="fl">2022</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># (...)</span></span>
<span><span class="co"># Hansen_GFC-2023-v1.11_lossyear_40N_010W.tif already exists and verified - skipping</span></span>
<span><span class="co"># Processing row 5328 with PLOT_ID EU2 and buffered area 0.19 ha ... </span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Hansen_GFC-2023-v1.11_lossyear_40N_010W.tif already exists and verified - skipping</span></span>
<span><span class="co"># Deforestation detected in 100% of the buffered area in plot row 5328 with PLOT_ID EU2. </span></span>
<span><span class="co"># The earliest measured year of deforestation is 2016.</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># Removed 354 plot(s) that have &gt; 5 % deforested area before/during the 2022 map year.</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">preprocessed_plots</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># $non_deforested_plots</span></span>
<span><span class="co"># Simple feature collection with 4974 features and 4 fields</span></span>
<span><span class="co"># Geometry type: POINT</span></span>
<span><span class="co"># Dimension:     XY</span></span>
<span><span class="co"># Bounding box:  xmin: -7.451944 ymin: 36.06354 xmax: 3.24262 ymax: 43.45025</span></span>
<span><span class="co"># Geodetic CRS:  WGS 84</span></span>
<span><span class="co"># First 10 features:</span></span>
<span><span class="co">#    PLOT_ID  AGB_T_HA AVG_YEAR SIZE_HA                    geometry</span></span>
<span><span class="co"># 1      EU2  45.90801     2002   0.196  POINT (-6.740698 38.14153)</span></span>
<span><span class="co"># 2      EU2  51.24531     2006   0.196   POINT (-5.06974 37.89271)</span></span>
<span><span class="co"># 3      EU2  69.61214     2004   0.196   POINT (-2.326055 38.2154)</span></span>
<span><span class="co"># 4      EU2  58.50748     2002   0.196  POINT (-4.500239 40.56834)</span></span>
<span><span class="co"># 5      EU2 130.73962     2000   0.196  POINT (-4.524572 43.13481)</span></span>
<span><span class="co"># 6      EU2  16.50173     2005   0.196 POINT (-0.9116234 42.72071)</span></span>
<span><span class="co"># 7      EU2  25.77160     2006   0.196   POINT (-5.17236 38.28734)</span></span>
<span><span class="co"># 8      EU2  77.99414     2001   0.196   POINT (2.830552 42.15426)</span></span>
<span><span class="co"># 9      EU2  85.97881     2001   0.196  POINT (-4.866867 39.29276)</span></span>
<span><span class="co"># 10     EU2  41.99649     2005   0.196  POINT (-2.718447 42.86548)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># $all_plots</span></span>
<span><span class="co"># Simple feature collection with 5328 features and 6 fields</span></span>
<span><span class="co"># Geometry type: POINT</span></span>
<span><span class="co"># Dimension:     XY</span></span>
<span><span class="co"># Bounding box:  xmin: -7.451944 ymin: 36.06354 xmax: 3.24262 ymax: 43.46688</span></span>
<span><span class="co"># Geodetic CRS:  WGS 84</span></span>
<span><span class="co"># First 10 features:</span></span>
<span><span class="co">#     PLOT_ID  AGB_T_HA AVG_YEAR SIZE_HA                    geometry defo defo_start_year</span></span>
<span><span class="co"># 299     EU2  45.90801     2002   0.196  POINT (-6.740698 38.14153)    0              NA</span></span>
<span><span class="co"># 300     EU2  51.24531     2006   0.196   POINT (-5.06974 37.89271)    0              NA</span></span>
<span><span class="co"># 301     EU2  69.61214     2004   0.196   POINT (-2.326055 38.2154)    0              NA</span></span>
<span><span class="co"># 302     EU2  58.50748     2002   0.196  POINT (-4.500239 40.56834)    0              NA</span></span>
<span><span class="co"># 303     EU2 130.73962     2000   0.196  POINT (-4.524572 43.13481)    0              NA</span></span>
<span><span class="co"># 304     EU2  16.50173     2005   0.196 POINT (-0.9116234 42.72071)    0              NA</span></span>
<span><span class="co"># 305     EU2  25.77160     2006   0.196   POINT (-5.17236 38.28734)    0              NA</span></span>
<span><span class="co"># 306     EU2  77.99414     2001   0.196   POINT (2.830552 42.15426)    0              NA</span></span>
<span><span class="co"># 307     EU2  85.97881     2001   0.196  POINT (-4.866867 39.29276)    0              NA</span></span>
<span><span class="co"># 308     EU2  41.99649     2005   0.196  POINT (-2.718447 42.86548)    0              NA</span></span></code></pre></div>
<p>We can see that the function returns a list containing two elements:</p>
<ul>
<li><p><code>$non_deforested_plots</code>: A <code>sf</code> object with non-deforested plots.</p></li>
<li><p><code>$all_plots</code>: The original input <code>sf</code> object with added deforestated proportion (0-1) w.r.t. to plot area and deforestation start year.</p></li>
</ul>
<p>In the next step we assign ecological zones and continents to plot locations. We use <code><a href="reference/BiomePair.html">BiomePair()</a></code> for this. This function overlays plot locations with pre-processed data to assign corresponding FAO ecological zones (biomes), Global Ecological Zones (GEZ) and continents (zones) to each plot:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preprocessed_plots_biome</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/BiomePair.html">BiomePair</a></span><span class="op">(</span><span class="va">preprocessed_plots</span><span class="op">$</span><span class="va">non_deforested_plots</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">preprocessed_plots_biome</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#   PLOT_ID  AGB_T_HA AVG_YEAR SIZE_HA  POINT_X  POINT_Y   ZONE               FAO.ecozone         GEZ</span></span>
<span><span class="co"># 1     EU2  26.57895     2001   0.196 1.967619 42.37488 Europe Temperate mountain system   Temperate</span></span>
<span><span class="co"># 2     EU2 207.19827     2001   0.196 1.943181 42.38366 Europe Temperate mountain system   Temperate</span></span>
<span><span class="co"># 3     EU2 106.25631     2001   0.196 2.319521 42.40453 Europe Temperate mountain system   Temperate</span></span>
<span><span class="co"># 4     EU2  56.08846     2001   0.196 1.820888 42.42750 Europe Temperate mountain system   Temperate</span></span>
<span><span class="co"># 5     EU2 143.96612     2001   0.196 3.036482 42.45157 Europe    Subtropical dry forest Subtropical</span></span>
<span><span class="co"># 6     EU2 100.97905     2001   0.196 1.723664 42.42646 Europe Temperate mountain system   Temperate</span></span></code></pre></div>
<p>In the step below we use <code><a href="reference/TempApplyVar.html">TempApplyVar()</a></code> to adjust plot biomass values to align with the map year by adding or subtracting annual growth increment to older or newer plots. The function uses growth data from a model-based estimate of growth-age relationships. The function also computes the temporal variance (standard deviation) of biomass changes based on growth-rate standard deviations. In the example below we apply temporal adjustment and calculate variance to all Global Ecological Zones (GEZ) within the plot data:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">preprocessed_plots_biome_temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/TempApplyVar.html">TempApplyVar</a></span><span class="op">(</span><span class="va">preprocessed_plots_biome</span>, <span class="fl">2022</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">preprocessed_plots_biome_temp</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#   PLOT_ID  AGB_T_HA AVG_YEAR SIZE_HA  POINT_X  POINT_Y   ZONE               FAO.ecozone         GEZ AGB_T_HA_ORIG sdGrowth</span></span>
<span><span class="co"># 1     EU2  91.67895     2001   0.196 1.967619 42.37488 Europe Temperate mountain system   Temperate      26.57895     65.1</span></span>
<span><span class="co"># 2     EU2 207.19827     2001   0.196 1.943181 42.38366 Europe Temperate mountain system   Temperate     207.19827      0.0</span></span>
<span><span class="co"># 3     EU2 106.25631     2001   0.196 2.319521 42.40453 Europe Temperate mountain system   Temperate     106.25631      0.0</span></span>
<span><span class="co"># 4     EU2 121.18846     2001   0.196 1.820888 42.42750 Europe Temperate mountain system   Temperate      56.08846     65.1</span></span>
<span><span class="co"># 5     EU2 164.96612     2001   0.196 3.036482 42.45157 Europe    Subtropical dry forest Subtropical     143.96612     21.0</span></span>
<span><span class="co"># 6     EU2 100.97905     2001   0.196 1.723664 42.42646 Europe Temperate mountain system   Temperate     100.97905      0.0</span></span></code></pre></div>
<p>Note how the <code>$AGB_T_HA</code>, <code>$AGB_T_HA_ORIG</code> and <code>$sdGrowth</code> columns are added to the plot dataset. The first corresponding to the adjusted biomass values for the specified <code>map_year</code>, the second keeping the original biomass values before adjustment and the last adding the temporal standard deviation of the biomass adjustment.</p>
</div>
<div class="section level3">
<h3 id="agb-map-validation">AGB map validation<a class="anchor" aria-label="anchor" href="#agb-map-validation"></a>
</h3>
<p>Now let’s suppose we want to validate an AGB map on the <code>preprocessed_plots_biome_temp</code> data above. We give an example of doing this with the <code><a href="reference/invDasymetry.html">invDasymetry()</a></code> function where the AGB map is the ESA-CCI AGB dataset.</p>
<p>This function performs inverse dasymetric mapping on plot data. It selects plots based on given criteria, optionally aggregates them, and calculates tree cover fraction and AGB for each plot or cell. In our case we use a tree cover threshold of 10% meaning that only areas with tree cover percentage above this threshold will contribute to biomass estimates.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Validate AGB map</span></span>
<span><span class="va">AGBdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/invDasymetry.html">invDasymetry</a></span><span class="op">(</span>plot_data <span class="op">=</span> <span class="va">preprocessed_plots_biome_temp</span>,</span>
<span>                       dataset <span class="op">=</span> <span class="st">"esacci"</span>,</span>
<span>                       is_poly <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                       threshold <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                       map_year <span class="op">=</span> <span class="fl">2022</span>,</span>
<span>                       parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>                       </span>
<span><span class="co"># memfrac   : 0.5</span></span>
<span><span class="co"># tolerance : 0.1</span></span>
<span><span class="co"># verbose   : FALSE</span></span>
<span><span class="co"># todisk    : FALSE</span></span>
<span><span class="co"># tempdir   : /tmp/RtmpjdE3bA</span></span>
<span><span class="co"># datatype  : FLT4S</span></span>
<span><span class="co"># memmin    : 1</span></span>
<span><span class="co"># progress  : 3</span></span>
<span><span class="co"># 4975 plots or cells being processed...</span></span>
<span><span class="co"># Processing 4975 plots in 100 batches of up to 50 plots each</span></span>
<span><span class="co"># Processing complete. Results: </span></span>
<span><span class="co"># </span></span>
<span><span class="co">#     plotAGB_10 tfPlotAGB orgPlotAGB mapAGB SIZE_HA          x        y</span></span>
<span><span class="co"># 1    91.678952  91.67895  26.578952     49   0.196  1.9676189 42.37488</span></span>
<span><span class="co"># 2   207.198266 207.19827 207.198266     95   0.196  1.9431806 42.38366</span></span>
<span><span class="co"># 3   106.256307 106.25631 106.256307    133   0.196  2.3195210 42.40453</span></span>
<span><span class="co"># 4   121.188457 121.18846  56.088457      6   0.196  1.8208879 42.42750</span></span>
<span><span class="co"># 5   164.966116 164.96612 143.966116    105   0.196  3.0364816 42.45157</span></span>
<span><span class="co"># 6    88.356669 100.97905 100.979051    114   0.196  1.7236641 42.42646</span></span>
<span><span class="co"># (...)</span></span></code></pre></div>
<p>Now that we have the validation data from <code><a href="reference/invDasymetry.html">invDasymetry()</a></code>, we can analyze and visualize the results. The function returns a data frame with several columns, including:</p>
<ul>
<li>
<code>plotAGB_[threshold]</code>: AGB values adjusted for forest cover threshold (e.g., plotAGB_10)</li>
<li>
<code>tfPlotAGB</code>: Tree-filtered plot AGB (only when not aggregated)</li>
<li>
<code>orgPlotAGB</code>: Original plot AGB values</li>
<li>
<code>mapAGB</code>: The AGB values extracted from the map</li>
<li>
<code>SIZE_HA</code>: Plot size in hectares</li>
<li>
<code>x</code> and <code>y</code>: Plot coordinates</li>
</ul>
<p>We can now visualize the relationship between the reference plot data and map values using the plotting functions:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visualize results with binned plot</span></span>
<span><span class="fu"><a href="reference/Binned.html">Binned</a></span><span class="op">(</span><span class="va">AGBdata</span><span class="op">$</span><span class="va">plotAGB_10</span>, <span class="va">AGBdata</span><span class="op">$</span><span class="va">mapAGB</span>, </span>
<span>       <span class="st">"EU2 Plots - Binned Comparison"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="reference/figures/binned_plot_readme.png" alt="binned_fig"><div class="figcaption">binned_fig</div>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a scatter plot</span></span>
<span><span class="fu"><a href="reference/Scatter.html">Scatter</a></span><span class="op">(</span><span class="va">AGBdata</span><span class="op">$</span><span class="va">plotAGB_10</span>, <span class="va">AGBdata</span><span class="op">$</span><span class="va">mapAGB</span>, </span>
<span>        <span class="st">"EU2 Plots - Scatter Plot"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="reference/figures/scatter_plot_readme.png" alt="scatter_fig"><div class="figcaption">scatter_fig</div>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate accuracy metrics</span></span>
<span><span class="co"># Use fewer intervals since we have a small sample</span></span>
<span><span class="fu"><a href="reference/Accuracy.html">Accuracy</a></span><span class="op">(</span><span class="va">AGBdata</span>, intervals <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#   AGB bin (Mg/ha)    n AGBref (Mg/ha) AGBmap (Mg/ha) RMSD varPlot</span></span>
<span><span class="co"># 1           0-100 3104             40             40   40       1</span></span>
<span><span class="co"># 2         100-150 1556            121             89   63       1</span></span>
<span><span class="co"># 3         150-200  157            170            128   76       1</span></span>
<span><span class="co"># 4         200-250   53            219            166   84       1</span></span>
<span><span class="co"># 5         250-300   19            270            146  139       1</span></span>
<span><span class="co"># 6            &gt;300   20            371            159  227       1</span></span>
<span><span class="co"># 7           total 4909             74             60   53       1</span></span></code></pre></div>
<p>The output of the <code><a href="reference/Accuracy.html">Accuracy()</a></code> function provides an assessment of map accuracy including binned statistics by AGB ranges.</p>
</div>
<div class="section level3">
<h3 id="handling-uncertainty">Handling Uncertainty<a class="anchor" aria-label="anchor" href="#handling-uncertainty"></a>
</h3>
<p>Plot2Map also provides a tool for calculating and incorporating plot uncertainty in plot data. The <code><a href="reference/calculateTotalUncertainty.html">calculateTotalUncertainty()</a></code> function combines measurement, sampling, and growth uncertainties. When uncertainty is not provided to plot data in the form of a <code>varPlot</code> column during inverse dasymetric mapping, <code><a href="reference/invDasymetry.html">invDasymetry()</a></code> will call <code><a href="reference/calculateTotalUncertainty.html">calculateTotalUncertainty()</a></code> to calculate and add plot uncertainty to plot data automatically.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate total plot uncertainty</span></span>
<span><span class="va">preprocessed_plots_biome_temp_uncertainty</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/calculateTotalUncertainty.html">calculateTotalUncertainty</a></span><span class="op">(</span><span class="va">preprocessed_plots_biome_temp</span>, </span>
<span>                                               map_year <span class="op">=</span> <span class="fl">2022</span>,</span>
<span>                                               map_resolution <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span>                                               </span>
<span><span class="co"># Calculating tree measurement uncertainty using RF model</span></span>
<span><span class="co"># Calculating sampling uncertainty using Rejou-Mechain approach</span></span>
<span><span class="co"># Loading sampling error data from package file</span></span>
<span><span class="co"># Using existing growth uncertainty (sdGrowth) values</span></span>
<span><span class="co"># Total uncertainty calculated for plot data of type: point</span></span>
<span></span>
<span><span class="co"># Print the uncertainty components</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">preprocessed_plots_biome_temp_uncertainty</span><span class="op">$</span><span class="va">uncertainty_components</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># measurement    sampling      growth </span></span>
<span><span class="co">#   0.2337400   0.1331422   0.6331177 </span></span>
<span></span>
<span><span class="co"># Inspect plot data with uncertainty</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">preprocessed_plots_biome_temp_uncertainty</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#   PLOT_ID  AGB_T_HA AVG_YEAR SIZE_HA  POINT_X  POINT_Y   ZONE               FAO.ecozone         GEZ AGB_T_HA_ORIG sdGrowth   sdTree RS_HA ratio     sdSE   varPlot  sdTotal</span></span>
<span><span class="co"># 1     EU2  91.67895     2001   0.196 1.967619 42.37488 Europe Temperate mountain system   Temperate      26.57895     65.1 21.28590     1 0.196 22.01657 5175.8289 71.94323</span></span>
<span><span class="co"># 2     EU2 207.19827     2001   0.196 1.943181 42.38366 Europe Temperate mountain system   Temperate     207.19827      0.0 29.50758     1 0.196 22.01657 1355.4264 36.81612</span></span>
<span><span class="co"># 3     EU2 106.25631     2001   0.196 2.319521 42.40453 Europe Temperate mountain system   Temperate     106.25631      0.0 21.56276     1 0.196 22.01657  949.6819 30.81691</span></span>
<span><span class="co"># 4     EU2 121.18846     2001   0.196 1.820888 42.42750 Europe Temperate mountain system   Temperate      56.08846     65.1 24.19848     1 0.196 22.01657 5308.3057 72.85812</span></span>
<span><span class="co"># 5     EU2 164.96612     2001   0.196 3.036482 42.45157 Europe    Subtropical dry forest Subtropical     143.96612     21.0 35.91662     1 0.196 22.01657 2215.7332 47.07157</span></span>
<span><span class="co"># 6     EU2 100.97905     2001   0.196 1.723664 42.42646 Europe Temperate mountain system   Temperate     100.97905      0.0 21.25330     1 0.196 22.01657  936.4321 30.60118</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="aggregated-analysis">Aggregated Analysis<a class="anchor" aria-label="anchor" href="#aggregated-analysis"></a>
</h3>
<p>Plot2Map allows for spatial aggregation of plots into larger cells for analysis at different scales:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Aggregated analysis at 0.1 degree resolution with minimum 3 plots per cell</span></span>
<span><span class="va">AGBdata_agg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/invDasymetry.html">invDasymetry</a></span><span class="op">(</span>plot_data <span class="op">=</span> <span class="va">preprocessed_plots_biome_temp_uncertainty</span><span class="op">$</span><span class="va">data</span>,</span>
<span>                           clmn <span class="op">=</span> <span class="st">"ZONE"</span>, </span>
<span>                           value <span class="op">=</span> <span class="st">"Europe"</span>,</span>
<span>                           aggr <span class="op">=</span> <span class="fl">0.1</span>,         <span class="co"># 0.1 degree aggregation</span></span>
<span>                           minPlots <span class="op">=</span> <span class="fl">3</span>,       <span class="co"># Minimum 3 plots per cell</span></span>
<span>                           dataset <span class="op">=</span> <span class="st">"esacci"</span>,</span>
<span>                           is_poly <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize aggregated results</span></span>
<span><span class="fu"><a href="reference/Binned.html">Binned</a></span><span class="op">(</span><span class="va">AGBdata_agg</span><span class="op">$</span><span class="va">plotAGB_10</span>, <span class="va">AGBdata_agg</span><span class="op">$</span><span class="va">mapAGB</span>, </span>
<span>      <span class="st">"Europe - Aggregated 0.1 arc-deg"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="working-with-different-plot-types">Working with Different Plot Types<a class="anchor" aria-label="anchor" href="#working-with-different-plot-types"></a>
</h3>
<p>Plot2Map can handle various types of plot data:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Point data with AGB estimates</strong>:
<ul>
<li>Pre-formatted (see documentation)</li>
<li>Unformatted (can be processed with <code><a href="reference/RawPlots.html">RawPlots()</a></code>)</li>
</ul>
</li>
<li>
<strong>Polygon data with corner coordinates</strong>:
<ul>
<li>Can be processed with <code><a href="reference/Polygonize.html">Polygonize()</a></code>
</li>
</ul>
</li>
<li>
<strong>Tree-level measurement data</strong>:
<ul>
<li>Processed with <code>MeasurementErr()</code> which estimates AGB and uncertainty</li>
</ul>
</li>
<li>
<strong>Nested plot data (with sub-plots)</strong>:
<ul>
<li>Processed with <code><a href="reference/Nested.html">Nested()</a></code> followed by <code>MeasurementErr()</code>
</li>
</ul>
</li>
<li>
<strong>Lidar-based reference maps</strong>:
<ul>
<li>Processed with <code><a href="reference/RefLidar.html">RefLidar()</a></code>
</li>
</ul>
</li>
</ol>
<p>See the “Plot data preparation” vignette for more information.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Araza et al., A comprehensive framework for assessing the accuracy and uncertainty of global above-ground biomass maps, Remote Sensing of Environment, Volume 272, 2022, 112917, ISSN 0034-4257, <a href="https://doi.org/10.1016/j.rse.2022.112917" class="external-link uri">https://doi.org/10.1016/j.rse.2022.112917</a>.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing Plot2Map</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://github.com/arnanaraza" class="external-link">Arnan Araza</a> <br><small class="roles"> Author </small>   </li>
<li>
<a href="https://github.com/aTnT" class="external-link">André Tavares</a> <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/arnanaraza" class="external-link">Arnan Araza</a>, <a href="https://github.com/aTnT" class="external-link">André Tavares</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
