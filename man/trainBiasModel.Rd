% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/BiasModel.R
\name{trainBiasModel}
\alias{trainBiasModel}
\title{Train Random Forest model to predict AGB map bias}
\usage{
trainBiasModel(
  bias_data,
  predictors = c("map", "sd", "height", "biome", "treecover", "slope", "aspect", "ifl"),
  response = "bias",
  method = "ranger",
  seed = 1234,
  cv_folds = NULL,
  importance = TRUE,
  ...
)
}
\arguments{
\item{bias_data}{data.frame output from \code{\link{extractBiasCovariates}},
containing bias values and covariate columns. Must include all columns
specified in \code{predictors} and the column specified in \code{response}.}

\item{predictors}{Character vector of predictor variable names to use in the
model. These should be column names in \code{bias_data}. Common predictors
include: "map", "sd", "height", "biome", "treecover", "slope", "aspect", "ifl".
Default uses all standard covariates.}

\item{response}{Character string specifying the response variable column name.
Default is "bias".}

\item{method}{Character string specifying the Random Forest implementation to use.
Options are:
\itemize{
\item "ranger" (default): Uses the ranger package for fast training
\item "randomForest": Uses the randomForest package
}}

\item{seed}{Integer for random seed to ensure reproducibility. Default is 1234.}

\item{cv_folds}{Integer specifying number of folds for k-fold cross-validation.
If NULL (default), no cross-validation is performed. If specified (e.g., 10),
performs k-fold CV and returns performance metrics.}

\item{importance}{Logical indicating whether to calculate variable importance.
Default is TRUE.}

\item{...}{Additional arguments passed to \code{ranger::ranger} or
\code{randomForest::randomForest}.}
}
\value{
A list with the following components:
\describe{
\item{model}{The trained Random Forest model object (class "ranger" or
"randomForest" depending on method)}
\item{importance}{data.frame with variable importance scores. For ranger,
uses impurity-based importance. For randomForest, uses IncNodePurity.
Sorted by importance in descending order.}
\item{cv_results}{If cv_folds is specified, a data.frame with cross-validation
metrics including RMSE, MAE, and R-squared for each fold and overall.
NULL if cv_folds is NULL.}
\item{formula}{The model formula used}
\item{predictors}{Character vector of predictor names used}
\item{method}{Character string indicating which method was used}
\item{n_obs}{Number of observations used for training (after removing NAs)}
}
}
\description{
This function trains a Random Forest model to predict systematic bias in AGB
maps as a function of environmental and map-derived covariates. The trained
model can be used to generate wall-to-wall bias predictions for map correction.
This implements the bias modeling approach from Araza et al. (2022).
}
\details{
The Random Forest model learns the relationship between environmental
map covariates and systematic bias in the AGB map.

The model trains on the relationship:
\deqn{bias = f(covariates) + \epsilon}{bias = f(covariates) + epsilon}

Where bias = mapAGB - plotAGB, and f() is learned by the Random Forest.

The ranger package is recommended for faster training, especially with large
datasets or when performing cross-validation. The function automatically removes
rows with NA values in any predictor or response variable before training.

When \code{cv_folds} is specified, the function performs k-fold cross-validation
to assess model performance. This is useful for model evaluation and comparison.
}
\examples{
\dontrun{
# Following from extractBiasCovariates example
# Assuming bias_data is already created

# Train model with default settings
bias_model <- trainBiasModel(
  bias_data = bias_data,
  predictors = c("map", "sd", "height", "treecover")
)

# View variable importance
print(bias_model$importance)

# Train with cross-validation
bias_model_cv <- trainBiasModel(
  bias_data = bias_data,
  predictors = c("map", "sd", "height", "treecover"),
  cv_folds = 10
)

# View CV performance
print(bias_model_cv$cv_results)
}

}
\references{
Araza, A., et al. (2022). A comprehensive framework for assessing the accuracy
and uncertainty of global above-ground biomass maps. Remote Sensing of Environment,
272, 112917. https://doi.org/10.1016/j.rse.2022.112917

Wright, M. N. & Ziegler, A. (2017). ranger: A Fast Implementation of Random
Forests for High Dimensional Data in C++ and R. Journal of Statistical Software,
77(1), 1-17. https://doi.org/10.18637/jss.v077.i01
}
\seealso{
\code{\link{extractBiasCovariates}} for preparing the input data,
\code{\link{predictBiasMap}} for generating wall-to-wall predictions,
\code{\link{adjustMapBias}} for applying the bias correction
}
