% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RefLidar.R
\name{RefLidar}
\alias{RefLidar}
\title{Process LiDAR-based Reference Data}
\usage{
RefLidar(
  lidar.dir,
  auto_detect = TRUE,
  pattern_config = NULL,
  raster_type = NULL,
  allow_interactive = TRUE
)
}
\arguments{
\item{lidar.dir}{Directory containing ALS raster files}

\item{auto_detect}{Enable automatic pattern detection for PLOT_ID and YEAR (default: TRUE)}

\item{pattern_config}{Optional manual pattern configuration (overrides auto-detection)}

\item{raster_type}{Optional raster type specification ("AGB", "CV", or "SD"). If NULL, auto-detects from filename or prompts user.}

\item{allow_interactive}{Allow interactive prompts if auto-detection fails (default: TRUE). Set to FALSE for automated pipelines.}
}
\value{
A data frame containing processed point data with columns varying based on the raster type:
\item{PLOT_ID}{Unique identifier for each plot (auto-extracted or user-specified)}
\item{POINT_X}{Longitude coordinate (WGS84)}
\item{POINT_Y}{Latitude coordinate (WGS84)}
\item{AGB/CV/SD}{Above Ground Biomass, Coefficient of Variation, or Standard Deviation (depending on raster type)}
\item{AVG_YEAR}{Year of data collection (standardized to 4-digit format)}
}
\description{
This function processes LiDAR-based reference data from raster files, converting them to a standardized point data format.
It includes multi-band raster handling, automatic pattern detection, and CRS validation.
}
\details{
The function performs the following steps:
\enumerate{
\item \strong{File Discovery}: Loads raster files and filters out auxiliary files (.aux.xml, .ovr, etc.)
\item \strong{CRS Validation}: Validates coordinate reference systems and reprojects to WGS84 (EPSG:4326) if necessary
\item \strong{Multi-band Processing}: Intelligently detects and extracts AGB layers from multi-band rasters (e.g., meanAGB, sdAGB, meanHbin layers)
\item \strong{Pattern Detection}: Automatically detects filename patterns for PLOT_ID and YEAR extraction. Supports multiple formats including Brazil (ANA_A01_2017_AGB_100m.tif), Central Africa (06_Nachtigal_AGB40.tif), Australia (GWW_2012_AGB_100m.tif), Czech Republic (BK17a_AGB_mean.tif), and Bulgaria (bul_agb2016_utm.tif)
\item \strong{Data Extraction}: Converts raster data to points with proper metadata
\item \strong{Quality Validation}: Validates extracted years and provides processing summary
}

The \code{raster_type} parameter enables fully non-interactive processing for automated pipelines. When NULL, attempts auto-detection from filename patterns or prompts user if \code{allow_interactive = TRUE}.
}
\examples{
\dontrun{
# Basic usage with automatic detection
lidar_data <- RefLidar(lidar.dir = "data/SustainableLandscapeBrazil_v04/SLB_AGBmaps")

# Non-interactive mode for automated pipelines
lidar_data <- RefLidar(
  lidar.dir = "data/SustainableLandscapeBrazil_v04/SLB_AGBmaps",
  raster_type = "AGB",
  allow_interactive = FALSE
)

# Process Coefficient of Variation rasters
cv_data <- RefLidar(
  lidar.dir = "data/uncertainty_maps/",
  raster_type = "CV",
  allow_interactive = FALSE
)

# Disable auto-detection for custom naming
lidar_data <- RefLidar(
  lidar.dir = "data/custom_naming/",
  auto_detect = FALSE,
  raster_type = "AGB"
)

# Manual pattern_config for custom filename formats
custom_pattern <- list(
  type = "custom",
  plot_start = 1,
  plot_end = 15,
  year_start = 22,
  year_end = 25,
  confidence = "high"
)
lidar_data <- RefLidar(
  lidar.dir = "data/custom_format/",
  pattern_config = custom_pattern,
  raster_type = "AGB"
)

# Pattern config for Brazil format (ANA_A01_2017_AGB_100m.tif)
brazil_pattern <- list(
  type = "site_code_year_type",
  plot_start = 1,
  plot_end = 3,
  year_start = 9,
  year_end = 12,
  confidence = "high"
)
brazil_data <- RefLidar(
  lidar.dir = "data/brazil_slb/",
  pattern_config = brazil_pattern,
  raster_type = "AGB"
)

# Multi-band raster processing
multiband_data <- RefLidar(
  lidar.dir = "data/LiDAR-based_biomass_maps_Central_Africa/",
  raster_type = "AGB"
)

# Processing multiple raster types from same directory
agb_data <- RefLidar(
  lidar.dir = "data/complete_dataset/",
  raster_type = "AGB",
  allow_interactive = FALSE
)
cv_data <- RefLidar(
  lidar.dir = "data/complete_dataset/",
  raster_type = "CV",
  allow_interactive = FALSE
)
combined_data <- merge(agb_data, cv_data,
                       by = c("PLOT_ID", "POINT_X", "POINT_Y", "AVG_YEAR"))
}
}
