<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Inverse dasymetric mapping — invDasymetry • Plot2Map</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Inverse dasymetric mapping — invDasymetry"><meta name="description" content="This function performs inverse dasymetric mapping on plot data. It selects plots
based on given criteria, optionally aggregates them, and calculates forest
fraction and Above Ground Biomass (AGB) data for each plot or cell."><meta property="og:description" content="This function performs inverse dasymetric mapping on plot data. It selects plots
based on given criteria, optionally aggregates them, and calculates forest
fraction and Above Ground Biomass (AGB) data for each plot or cell."><meta property="og:image" content="https://atnt.github.io/Plot2Map/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Plot2Map</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/plot-data-preparation.html">Plot data preparation</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Inverse dasymetric mapping</h1>

      <div class="d-none name"><code>invDasymetry.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs inverse dasymetric mapping on plot data. It selects plots
based on given criteria, optionally aggregates them, and calculates forest
fraction and Above Ground Biomass (AGB) data for each plot or cell.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">invDasymetry</span><span class="op">(</span></span>
<span>  plot_data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clmn <span class="op">=</span> <span class="st">"ZONE"</span>,</span>
<span>  value <span class="op">=</span> <span class="st">"Europe"</span>,</span>
<span>  aggr <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  minPlots <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  weighted_mean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  is_poly <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>,</span>
<span>  dataset <span class="op">=</span> <span class="st">"custom"</span>,</span>
<span>  agb_raster_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  forest_mask_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  esacci_biomass_year <span class="op">=</span> <span class="st">"latest"</span>,</span>
<span>  esacci_biomass_version <span class="op">=</span> <span class="st">"latest"</span>,</span>
<span>  esacci_folder <span class="op">=</span> <span class="st">"data/ESACCI-BIOMASS"</span>,</span>
<span>  gedi_l4b_folder <span class="op">=</span> <span class="st">"data/GEDI_L4B/"</span>,</span>
<span>  gedi_l4b_band <span class="op">=</span> <span class="st">"MU"</span>,</span>
<span>  gedi_l4b_resolution <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  timeout <span class="op">=</span> <span class="fl">600</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-plot-data">plot_data<a class="anchor" aria-label="anchor" href="#arg-plot-data"></a></dt>
<dd><p>data.frame, Plot dataset containing required columns.</p></dd>


<dt id="arg-clmn">clmn<a class="anchor" aria-label="anchor" href="#arg-clmn"></a></dt>
<dd><p>character, Column name for plot selection.</p></dd>


<dt id="arg-value">value<a class="anchor" aria-label="anchor" href="#arg-value"></a></dt>
<dd><p>character, Value to select in the specified column.</p></dd>


<dt id="arg-aggr">aggr<a class="anchor" aria-label="anchor" href="#arg-aggr"></a></dt>
<dd><p>numeric, Aggregation factor in degrees. NULL for no aggregation.</p></dd>


<dt id="arg-minplots">minPlots<a class="anchor" aria-label="anchor" href="#arg-minplots"></a></dt>
<dd><p>integer, Minimum number of plots per aggregated cell.</p></dd>


<dt id="arg-weighted-mean">weighted_mean<a class="anchor" aria-label="anchor" href="#arg-weighted-mean"></a></dt>
<dd><p>logical, Whether to use weighted mean for calculations.</p></dd>


<dt id="arg-is-poly">is_poly<a class="anchor" aria-label="anchor" href="#arg-is-poly"></a></dt>
<dd><p>logical, Whether input plots are polygons.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>logical, Enable parallel processing. Default is FALSE.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>numeric, Number of cores to use for parallel processing.</p></dd>


<dt id="arg-dataset">dataset<a class="anchor" aria-label="anchor" href="#arg-dataset"></a></dt>
<dd><p>character, Dataset for AGB estimation: "custom", "esacci", or "gedi". Default is "custom".</p></dd>


<dt id="arg-agb-raster-path">agb_raster_path<a class="anchor" aria-label="anchor" href="#arg-agb-raster-path"></a></dt>
<dd><p>character, File path to the custom AGB raster.</p></dd>


<dt id="arg-forest-mask-path">forest_mask_path<a class="anchor" aria-label="anchor" href="#arg-forest-mask-path"></a></dt>
<dd><p>character, File path to the forest mask raster.</p></dd>


<dt id="arg-threshold">threshold<a class="anchor" aria-label="anchor" href="#arg-threshold"></a></dt>
<dd><p>numeric, Threshold (0-100) for tree cover calculation and forest masking (e.g. 0 or 10).</p></dd>


<dt id="arg-esacci-biomass-year">esacci_biomass_year<a class="anchor" aria-label="anchor" href="#arg-esacci-biomass-year"></a></dt>
<dd><p>The ESA CCI BIOMASS AGB tiles year to use. Use either 2010, 2015, 2016, 2017, 2018, 2019,
2020, 2021 or "latest" (default).</p></dd>


<dt id="arg-esacci-biomass-version">esacci_biomass_version<a class="anchor" aria-label="anchor" href="#arg-esacci-biomass-version"></a></dt>
<dd><p>The ESA CCI BIOMASS AGB tiles version to use. Use either "v2.0", "v3.0", "v4.0",
"v5.0", "v5.01" or "latest" (default).</p></dd>


<dt id="arg-esacci-folder">esacci_folder<a class="anchor" aria-label="anchor" href="#arg-esacci-folder"></a></dt>
<dd><p>Directory to save downloaded ESA CCI BIOMASS AGB files. Default is the relative path "data/ESACCI-BIOMASS".</p></dd>


<dt id="arg-gedi-l-b-folder">gedi_l4b_folder<a class="anchor" aria-label="anchor" href="#arg-gedi-l-b-folder"></a></dt>
<dd><p>Character, the folder to save the downloaded GeoTIFF file. Default is "data/GEDI_L4B/".</p></dd>


<dt id="arg-gedi-l-b-band">gedi_l4b_band<a class="anchor" aria-label="anchor" href="#arg-gedi-l-b-band"></a></dt>
<dd><p>Character, the band to filter for. See options in the Details section below. Default is "MU".</p></dd>


<dt id="arg-gedi-l-b-resolution">gedi_l4b_resolution<a class="anchor" aria-label="anchor" href="#arg-gedi-l-b-resolution"></a></dt>
<dd><p>Numeric, the spatial resolution of the processed output GeoTIFF in degrees. The native resolution of the GEDI L4B gridded dataset is 1 km,
approximately 0.001 degrees at the equator. Default is 0.001.</p></dd>


<dt id="arg-timeout">timeout<a class="anchor" aria-label="anchor" href="#arg-timeout"></a></dt>
<dd><p>Number of seconds for reaching file download timeout.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with the following columns:</p>
<dl><dt>plotAGB_threshold</dt>
<dd><p>AGB values for the given forest threshold (e.g., plotAGB_10 if threshold=10)</p></dd>

<dt>tfPlotAGB</dt>
<dd><p>Tree-filtered plot AGB (only when not aggregated)</p></dd>

<dt>orgPlotAGB</dt>
<dd><p>Original plot AGB</p></dd>

<dt>mapAGB</dt>
<dd><p>AGB from map sampling</p></dd>

<dt>SIZE_HA</dt>
<dd><p>Plot size in hectares</p></dd>

<dt>x</dt>
<dd><p>X-coordinate of plot</p></dd>

<dt>y</dt>
<dd><p>Y-coordinate of plot</p></dd>

<dt>n</dt>
<dd><p>Number of plots (only if aggregated)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs the following steps:</p><ol><li><p>Selects plots based on the specified criteria.</p></li>
<li><p>Optionally aggregates plots if <code>aggr</code> is not NULL.</p></li>
<li><p>Calculates forest fraction and AGB for each plot or cell.</p></li>
<li><p>Samples AGB from custom raster or downloads and uses ESA CCI BIOMASS or GEDI L4B data.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>

<ul><li><p>Ensure all required columns are present in the input plot data.</p></li>
<li><p>For parallel processing, adjust <code>n_cores</code> based on your system's capabilities.</p></li>
<li><p>Large datasets may require significant processing time and memory.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Create a sample dataset of 10 plots:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sampled_plots</span> <span class="op">&lt;-</span> <span class="va">plots</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/dimensions.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">plots</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="Deforested.html">Deforested</a></span><span class="op">(</span><span class="va">sampled_plots</span>, gfc_folder <span class="op">=</span> <span class="va">test_dir</span>,  map_year <span class="op">=</span> <span class="va">test_year</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="BiomePair.html">BiomePair</a></span><span class="op">(</span><span class="va">sampled_plots</span><span class="op">$</span><span class="va">non_deforested_plots</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plot_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="TempApply.html">TempApply</a></span><span class="op">(</span><span class="va">plot_data</span>, <span class="va">test_year</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">invDasymetry</span><span class="op">(</span>plot_data <span class="op">=</span> <span class="va">plot_data</span>,</span></span>
<span class="r-in"><span>                       clmn <span class="op">=</span> <span class="st">"ZONE"</span>,</span></span>
<span class="r-in"><span>                       value <span class="op">=</span> <span class="st">"Europe"</span>,</span></span>
<span class="r-in"><span>                       aggr <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                       parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                       dataset <span class="op">=</span> <span class="st">"esacci"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/arnanaraza" class="external-link">Arnan Araza</a>, <a href="https://github.com/aTnT" class="external-link">André Tavares</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

